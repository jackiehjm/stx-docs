.. _ptp-notification-status-conditions-6d6105fccf10:

==================================
PTP Notification Status Conditions
==================================

The |PTP| status notifications are derived based on the following conditions:

.. table::
    :widths: auto

    +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |                                                                      **PTP Lock State**                                                                                                                                                     |
    +=====================+===================================================+===================================================================================================================================================================+
    | Clock Status        | Status                                            | Description                                                                                                                                                       |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Freerun             | Clock is out of sync state                        | -   If portState is not “SECONDARY” or ClockClass value is NOT "6" or timeTraceable flag is FALSE.                                                                |
    |                     |                                                   |                                                                                                                                                                   |
    |                     |                                                   | -   If holdover time exceeds its provided value.                                                                                                                  |
    |                     |                                                   |                                                                                                                                                                   |
    |                     |                                                   | -   If PMC, ptp4l.conf, ptp4l or phc2sys are not accessible.                                                                                                      |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Locked              | Clock is in sync state                            | If portState is "SECONDARY" and ClockClass value is "6" and timeTraceable flag is TRUE and PMC, ptp4l.conf, ptp4l or phc2sys are accessible.                      |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Holdover            | Clock is in holdover state                        | * For NICs using the Intel ice driver: If the state is transitioned from ``Locked`` to ``Holdover`` AND phc2sys is accessible, and holdover time does not expire. |
    |                     |                                                   |                                                                                                                                                                   |
    |                     |                                                   | * For other NIC types: If the state is transitioned from ``Locked`` to ``Freerun`` AND phc2sys is accessible, and holdover time does not expire.                  |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |                                                                  **PTP Clock Class**                                                                                                                                                        |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | 6                   | T-GM connected to a PRTC in locked mode           | * For additional details on clockClass values, refer to ITU-T standard G.8275.1                                                                                   |
    |                     | (e.g., PRTC traceable to GNSS)                    |                                                                                                                                                                   |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | 7                   | T-GM in holdover, within holdover specification,  |                                                                                                                                                                   |
    |                     | traceable to Category 1 frequency source          |                                                                                                                                                                   |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | 135                 | T-BC in holdover, within holdover specification   |                                                                                                                                                                   |
    |                     | traceable to Category 1 frequency source          |                                                                                                                                                                   |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | 140                 | T-GM in holdover, out of holdover specification,  |                                                                                                                                                                   |
    |                     | traceable to Category 1 frequency source          |                                                                                                                                                                   |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | 248                 | T-GM or T-BC in free-run mode                     |                                                                                                                                                                   |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | 255                 | Slave only OC (does not send Announce messages)   |                                                                                                                                                                   |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |                                                                  **OS Clock State**                                                                                                                                                         |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Locked              | Clock is out of sync state                        | * phc2sys is running and disciplining the os clock                                                                                                                |
    |                     |                                                   | * OS clock is within 1000 ns of 37000000000 expected offset from PHC                                                                                              |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Holdover            | Clock is in holdover state                        | * Holdover timer has not expired                                                                                                                                  |
    |                     |                                                   | * phc2sys is not running and not disciplining the os clock                                                                                                        |
    |                     |                                                   | * OR os clock offset is outside of range                                                                                                                          |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Freerun             | Clock is in freerun                               | * Holdover conditions met but holdover timer has expired                                                                                                          |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |                                                                  **GNSS State**                                                                                                                                                             |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | SYNCHRONIZED        | GNSS data is present                              | *  ts2phc is running and disciplining NIC PHC                                                                                                                     |
    |                     |                                                   | * NIC driver DPLL reports GNSS state is locked                                                                                                                    |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | FAILURE-NOFIX       | GNSS data is not detected                         | * ts2phc is not running, NIC PHC is not being disciplined                                                                                                         |
    |                     |                                                   | * NIC driver DPLL reports status other than locked                                                                                                                |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |                                                               **Overall Sync State**                                                                                                                                                        |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Locked              | Overall state is locked                           | * All monitored services are Locked or Synchronized (excluding clockClass)                                                                                        |
    |                     |                                                   |                                                                                                                                                                   |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    |                                                               **PTP Lock State**                                                                                                                                                            |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Holdover            | Overall state is in holdover                      | * One or more monitored services are in a degraded state (holdover or freerun)                                                                                    |
    |                     |                                                   | * Overall sync state holdover time has not expired                                                                                                                |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Freerun             | Overall state is freerun                          | * One or more monitored services are in a degraded state (holdover or freerun)                                                                                    |
    |                     |                                                   | * Overall sync state holdover time has expired                                                                                                                    |
    +---------------------+---------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
